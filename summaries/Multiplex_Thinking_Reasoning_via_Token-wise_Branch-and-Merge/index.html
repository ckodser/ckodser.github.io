<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image4.png" sizes="95vw"></source> <img src="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h1 id="lm-head-reweighting">LM-Head Reweighting</h1> <p>The process initiates with the model’s probability distribution $p$ over the entire vocabulary $\mathcal{V}$. From this distribution, $K$ independent token samples, denoted as the multiset ${k_1, k_2, \dots, k_K}$, are drawn. A set of unique candidate tokens, $\mathcal{S}$, is then formed from these samples, where $\mathcal{S}$ contains every token that was sampled at least once. The frequency of any given token’s appearance in the initial draw is ignored.</p> <p>The core of the reweighting calculation involves deriving a new weight, $w(v)$, for each token $v$ belonging to the unique set $\mathcal{S}$. This weight is computed by renormalizing its original probability $p(v)$ exclusively over the candidates present in $\mathcal{S}$. So $w(v) = p(v) / \sum_{u \in \mathcal{S}} p(u)$.</p> <p>The final soft input token is weighted average of token embeddings with $w(v)$ weigths.</p> <h1 id="analysis">Analysis</h1> <p>1) Multiplex representations help without training. (Multiplex Thinking-I)</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image1.png" sizes="95vw"></source> <img src="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>2) K&gt;1 is enough. K=2,3,6 they all work.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image2.png" sizes="95vw"></source> <img src="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>3) They improve both Pass-1 till Pass-1024</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image3.png" sizes="95vw"></source> <img src="/assets/img/Multiplex_Thinking_Reasoning_via_Token-wise_Branch-and-Merge/image3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </body></html>