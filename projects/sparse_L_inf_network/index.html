<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Certified Robust Neural Network | Arshia Soltani Moakhar</title> <meta name="author" content="Arshia Soltani Moakhar"/> <meta name="description" content="Certify Robustness using median neurons"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, research, Arshia Soltani Moakhar, ckodser, adversarial training, OOD detection"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon3.ico"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://ckodser.github.io/projects/sparse_L_inf_network/"> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"><span class="font-weight-bold">Arshia </span>Soltani Moakhar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">Summaries</a> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Certified Robust Neural Network</h1> <p class="post-description">Certify Robustness using median neurons</p> </header> <article> <p>L-inf dist neurons are introduced by <a href="https://github.com/zbh2047/L_inf-dist-net" target="_blank" rel="noopener noreferrer">zhang2021towards</a>. With this neuron, they have achieved superior certified accuracy on various datasets, including CIFAR-10.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/inf-neuron-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/inf-neuron-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/inf-neuron-1400.webp"></source> <img src="/assets/img/inf-neuron.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="L-Inf distance neuron" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This illustration shows how an L-inf distance neuron works. </div> <p>As shown in the illustration, each neuron calculated the L-inf dist of its input to some learnable point, plus a fixed constant. With this formulation, the Lipschitz of each neuron output with respect to its input is \(1\); Therefore, each layer Lipschitz is equal to \(1\), and further, the whole network is Lipschitz one. Lipschitz’s networks could easily certify their robustness under L-inf perturbations.</p> <p>In the first experiment, I discovered that this network could be pruned by a staggering 98% without any loss in accuracy or certified accuracy.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sparseNeuron-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sparseNeuron-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sparseNeuron-1400.webp"></source> <img src="/assets/img/sparseNeuron.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="sparsed L-Inf distance neuron" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The sparsification of an L-Inf distance neuron, where only certain dimensions are considered, effectively reducing the edges by 98%. </div> <p>As depicted above, the neurons calculate the L-inf distance only along certain dimensions, while others are ignored. In this visualization, each dimension corresponds to an edge in the graph, illustrating a substantial reduction of 98% in connections without compromising accuracy or certified accuracy.</p> <p>The approach in which we chose edges to remove was straightforward. Using the training dataset, we count how many samples a specific edge causes the L-inf distance change. L-inf distance could be seen as a max function on absolute values. Mathematically<br> \(\| W \| = max(\|W_i\|)\)<br> So in each Maximum, we checked which element matters. After this calculation, we remove edges that counted less than a specific constant.</p> <p>This work raises an interesting question if this network does not use its total capacity, what happens if it does? It is an essential question since it has been proved that robustness needs more parameters, and if our network does not use its total capacity, it somehow means it has fewer parameters. To mitigate this issue, I proposed median-neuron, which calculates \(y=median(X_i-W_i)+b\) instead of \(y=max(\|X_i-W_i\|)\). At first, it seems this neuron could get higher accuracy and robust accuracy since the median is a robust function by its nature. Nevertheless, we were not able to train this network properly.</p> <p>In addition to the median, we tried \(r\)-the element in the sorted array function. It means each neuron has a learnable \(R\), and its output is calculated as follows</p> <center>$$y=(Sorted(X_i-W_i)_R)+b$$</center> <p>to make these \(R\)s learnable, we should apply some normalization to the \(R\)-th element function; Therefore, during training, we applied</p> <center>$$y=\sum_{i} {Sorted_i(X_j-W_j)}{T(\|R-i\|)}+b$$</center> <p>In which T is a decreasing function. By making T steeper, we converge to the \(R\)-th function.</p> <p>The code is available on <a href="https://github.com/ckodser/L_inf_dist_mean" target="_blank" rel="noopener noreferrer">GitHub</a>.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Arshia Soltani Moakhar. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>