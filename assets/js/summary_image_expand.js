function summaryMaxWidthForAspectRatio(t){if(!Number.isFinite(t)||t<=0)return"50%";if(t<=1.2)return"50%";if(t<=1.7){const e=(t-1.2)/.5;return`${Math.round(50+15*e)}%`}if(t<=2.6){const e=(t-1.7)/(2.6-1.7);return`${Math.round(65+20*e)}%`}return"92%"}function applySummarySizingFromImage(t,e){const n=()=>{const n=e.naturalWidth,r=e.naturalHeight;if(!n||!r)return;const o=n/r;t.style.setProperty("--summary-img-max-width",summaryMaxWidthForAspectRatio(o))};e.complete?n():e.addEventListener("load",n,{once:!0})}function initSummaryImageExpandButtons(){if(!document.body)return;if(!(document.body.classList.contains("collection-summaries")||document.body.classList.contains("collection-projects")))return;const t=document.querySelectorAll(".post article figure, .post.distill d-article figure");t.length&&t.forEach(t=>{if(t.querySelector(":scope > .summary-img-wrap"))return;const e=t.querySelector("picture"),n=t.querySelector("img");if(!e||!n)return;const r=document.createElement("span");r.className="summary-img-wrap",e.parentNode.insertBefore(r,e),r.appendChild(e),applySummarySizingFromImage(r,n),n.setAttribute("data-zoomable","");const o=document.createElement("button");o.type="button",o.className="summary-img-expand",o.setAttribute("aria-label","Expand image"),o.title="Expand",o.innerHTML='<svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M4 10V4h6v2H6v4H4zm14 0V6h-4V4h6v6h-2zM10 20H4v-6h2v4h4v2zm10 0h-6v-2h4v-4h2v6z"/></svg>',o.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const e=window.medium_zoom;if(e&&"function"==typeof e.open)return"function"==typeof e.attach&&e.attach(n),void e.open({target:n});const r=n.currentSrc||n.src;r&&window.open(r,"_blank","noopener,noreferrer")}),r.appendChild(o)})}document.addEventListener("DOMContentLoaded",initSummaryImageExpandButtons);